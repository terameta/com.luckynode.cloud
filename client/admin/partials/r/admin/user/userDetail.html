<section class="content-header">
	<h1>
		<i class="fa fa-users fa-fw"></i> User
		<small>{{ curUser.name +' '+ curUser.surname || curUser.email || 'No name for current user'}}</small>
	</h1>
	<ol class="breadcrumb">
		<li><a ui-sref="r.dashboard"><i class="fa fa-home"></i> Dashboard</a></li>
		<li><a ui-sref="r.dashboard.users">Users</a></li>
		<li class="active">User</li>
	</ol>
</section>

<section class="content">
<div class="row">



</div>

<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
	<uib-tabset>
		<uib-tab index="0" heading="Details">
			<form editable-form name="userEditForm" onaftersave="saveUser()">
				<div class="table-responsive">
					<table class="table table-bordered table-condensed table-hover table-striped table-nonfluid">
						<tbody>
							<tr><td width=150><b>Name: 	</b></td><td><span editable-text="curUser.name">{{ curUser.name }}</span> <span editable-text="curUser.surname">{{ curUser.surname }}</span></td></tr>
							<tr><td><b>Email Address: 	</b></td><td><span editable-text="curUser.email" e-size="100">{{ curUser.email }}</span></td></tr>
							<tr><td><b>Role: 			</b></td><td>{{ curUser.role }}</td></tr>
							<tr><td><b>isVerified: 		</b></td><td>{{ curUser.verified }}</td></tr>
							<tr><td><b>Profession: 		</b></td><td><span editable-text="curUser.profession" e-size="100">{{ curUser.profession }}</span></td></tr>
							<tr><td><b>Address: 		</b></td><td><span editable-textarea="curUser.address" e-rows="5" e-cols="100"><pre style="background:transparent;border:0;padding:0">{{ curUser.address }}</pre></span></td></tr>
							<tr><td><b>hasPicture: 		</b></td><td>{{ curUser.haspicture }}</td></tr>
							<tr><td><b>Pay to: 			</b></td><td><span editable-textarea="curUser.payto" e-rows="5" e-cols="100"><pre style="background:transparent;border:0;padding:0">{{ curUser.payto }}</pre></span></td></tr>
							<tr>
								<td><b>Discount: 		</b></td>
								<td><span editable-text="curUser.discountAmount">{{ curUser.discountAmount }}</span>
									<span editable-select="curUser.discountType" e-ng-options="discountType.value as discountType.name for discountType in discountTypes" style="display:inline-block;">
										<span ng-if="curUser.discountType" ng-repeat="discountType in discountTypes | filter:{value:curUser.discountType}">{{discountType.name}}</span>
									</span>
								</td>
							</tr>
							<tr><td><b>Join Date: 		</b></td><td><span editable-text="curUser.joindate" e-size="100">{{ curUser.joindate }}</span></td></tr>
							<tr><td><b>Notes: 			</b></td><td><span editable-textarea="curUser.notes" e-rows="15" e-cols="100"><pre style="background:transparent;border:0;padding:0">{{ curUser.notes }}</pre></span></td></tr>
							<tr>
								<td colspan=2>
									<button type="button" class="btn btn-primary btn-xs" ng-click="userEditForm.$show()" ng-show="!userEditForm.$visible">Edit</button>
									<button type="button" class="btn btn-danger btn-xs" ng-click="deleteUser()" ng-show="!userEditForm.$visible">Delete</button>
									<button type="submit" class="btn btn-success btn-xs" ng-disabled="userEditForm.$waiting" ng-show="userEditForm.$visible">Save</button>
									<button type="button" class="btn btn-warning btn-xs" ng-disabled="userEditForm.$waiting" ng-click="userEditForm.$cancel()" ng-show="userEditForm.$visible">Cancel</button>
								</td>
							</tr>
							<!--tr>
								<td colspan="2">
									<pre>{{curUser | json}}</pre>
								</td>
							</tr-->
						</tbody>
					</table>
				</div>
			</form>
		</uib-tab>
		<uib-tab index="1" heading="Transactions">
			<div class="box box-default">
				<div class="box-header with-border">
					<h2 class="box-title"><b>Current Account Balance {{formatCurrency(curUser.accountBalance)}}</b></h2>
				</div>

			</div>
			<table class="table table-striped table-bordered table-hover" ng-if="curUser.accountTransactions.length > 0">
				<thead>
					<tr>
						<th>#</th>
						<th align="center">Date</th>
						<th align="center">Source</th>
						<th align="center">Details</th>
						<th align="center">Amount Spent</th>
						<th align="center">Amount Paid</th>
						<th><i class="fa fa-cog fa-fw"></i></th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="transaction in curUser.accountTransactions | orderBy:'-date'">
						<td>{{transaction.id}}</td>
						<td>{{formatDateTime(transaction.date)}}</td>
						<td>{{transaction.transactionBy}}</td>
						<td>{{transaction.details}}</td>
						<td align=right>{{formatCurrency(transaction.amountSpent || 0)}}</td>
						<td align=right>{{formatCurrency(transaction.amountPaid || 0)}}</td>
						<td><a ng-if="(transaction.transactionBy=='Invoice')" ui-sref="r.invoice({id: transaction.id})"><i class="fa fa-cog fa-fw"></i></a></td>
					</tr>
				</tbody>
			</table>
		</uib-tab>
	</uib-tabset>
	</div>
</div>
</section>