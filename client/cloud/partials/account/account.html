<section class="content-header">
	<h1>
		<i class="fa fa-file-text-o fa-fw"></i> Your Account
	</h1>
	<ol class="breadcrumb">
		<li><a ui-sref="r.dashboard"><i class="fa fa-home"></i> Dashboard</a></li>
		<li class="active">Account</li>
	</ol>
</section>
<!--pre>	{{invoices|json}}</pre-->
<section class="content">
<div class="row">
	<div class="col-xs-12 col-sm-6 col-md-3">
		<div class="box box-default">
			<div class="box-header with-border">
				<h2 class="box-title"><b>Your Account Balance</b></h2>
			</div>
			<div class="box-body">
				<div ng-if="shouldMakePayment">
					Your current account balance is <b>{{formatCurrency(accountBalance)}}</b>.<br />
					Please make a payment to ensure service continuity.
				</div>
				<div ng-if="!shouldMakePayment">
					Your current account balance is <b>{{formatCurrency(accountBalance)}}</b>.<br />
					Currently there is no need to pay anything.
				</div>
			</div>
		</div>
	</div>

	<div class="col-xs-12 col-sm-6 col-md-3" ng-if="shouldMakePayment">
		<div class="box box-default">
			<div class="box-header with-border">
				<h2 class="box-title"><b>Make a Payment</b></h2>
			</div>
			<div class="box-body">
				<button type="button" ng-click="paywithCC()"><i class="fa fa-credit-card-alt fa-fw"></i> Pay with Credit Card</button>
				<form action="{{systemSettings.paypalformlink}}" method="post" style=" display:inline!important;">
					<input type="hidden" name="business" value="{{systemSettings.paypal.email}}">

					<input type="hidden" name="cmd" value="_xclick">

					<input type="hidden" name="item_name" value="Account: {{ curUser.id }}">
					<input type="hidden" name="amount" value="{{ formatCurrency(accountBalance) }}">
					<input type="hidden" name="currency_code" value="USD">

					<input type="hidden" name="no_note" value="1">
					<input type="hidden" name="no_shipping" value="1">
					<input type="hidden" name="charset" value="utf-8">

					<input type="hidden" name="return" value="{{systemSettings.domain}}/api/payment/paypal/success/">
					<input type="hidden" name="cancel_return" value="{{systemSettings.domain}}/cloud/r/account">
					<input type="hidden" name="notify_url" value="{{systemSettings.domain}}/api/payment/paypal/IPN">

					<button type="submit"><i class="fa fa-paypal fa-fw"></i> Pay with PayPal</button>
				</form>
				<form action='https://www.2checkout.com/checkout/purchase' method='post' ng-if="curUser.id=='56e706756337414e45283cc6'">
					<input type='hidden' name='sid' value='1303908' />
					<input type='hidden' name='mode' value='2CO' />
					<input type='hidden' name='li_0_type' value='product' />
					<input type='hidden' name='li_0_name' value='invoice123' />
					<input type='hidden' name='li_0_price' value='25.99' />
					<input type='hidden' name='card_holder_name' value='Checkout Shopper' />
					<input type='hidden' name='street_address' value='123 Test Address' />
					<input type='hidden' name='street_address2' value='Suite 200' />
					<input type='hidden' name='city' value='Columbus' />
					<input type='hidden' name='state' value='OH' />
					<input type='hidden' name='zip' value='43228' />
					<input type='hidden' name='country' value='USA' />
					<input type='hidden' name='email' value='example@2co.com' />
					<input type='hidden' name='phone' value='614-921-2450' />
					<input name='submit' type='submit' value='Checkout' />
					<button type="submit"><i class="fa fa-credit-card-alt fa-fw"></i> Pay with 2CheckOut</button>
				</form>
			</div>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12">
		<table class="table table-striped table-bordered table-hover" ng-if="accountTransactions.length > 0">
			<thead>
				<tr>
					<th>#</th>
					<th align="center">Date</th>
					<th align="center">Source</th>
					<th align="center">Details</th>
					<th align="center">Amount Spent</th>
					<th align="center">Amount Paid</th>
					<th><i class="fa fa-cog fa-fw"></i></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="transaction in accountTransactions | orderBy:'-date'">
					<td>{{transaction.id}}</td>
					<td>{{formatDateTime(transaction.date)}}</td>
					<td>{{transaction.transactionBy}}</td>
					<td>{{transaction.details}}</td>
					<td align=right>{{formatCurrency(transaction.amountSpent || 0)}}</td>
					<td align=right>{{formatCurrency(transaction.amountPaid || 0)}}</td>
					<td><a ng-if="(transaction.transactionBy=='Invoice')" ui-sref="r.invoice({id: transaction.id})"><i class="fa fa-cog fa-fw"></i></a></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
</section>